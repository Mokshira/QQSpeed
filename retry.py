import keyboard
import pyautogui
import time
import base64
import cv2
import numpy as np
from io import BytesIO
from PIL import Image

listening_enabled = False

# 预留变量用于填入retry.png的base64编码
RETRY_IMAGE_BASE64 = "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"

# 将base64编码转换为OpenCV图像
def base64_to_cv2_image(base64_string):
    # 解码
    image_data = base64.b64decode(base64_string)
    # 将字节数据转换为PIL图像
    pil_image = Image.open(BytesIO(image_data))
    # 转换为OpenCV格式
    opencv_image = cv2.cvtColor(np.array(pil_image), cv2.COLOR_RGB2BGR)
    return opencv_image

# 找
def find(confidence=0.7, timeout=1):
    keyboard.press('esc') # 确保呼出界面
    time.sleep(0.02)
    
    # 将base64编码转换为OpenCV图像
    template_image = base64_to_cv2_image(RETRY_IMAGE_BASE64)
    
    start_time = time.time()
    while time.time() - start_time < timeout:
        try:
            # 截取屏幕
            screenshot = pyautogui.screenshot()
            screen_image = cv2.cvtColor(np.array(screenshot), cv2.COLOR_RGB2BGR)
            
            # 模板匹配
            result = cv2.matchTemplate(screen_image, template_image, cv2.TM_CCOEFF_NORMED)
            _, max_val, _, max_loc = cv2.minMaxLoc(result)
            
            if max_val >= confidence:
                # 计算匹配区域的中心点
                h, w = template_image.shape[:2]
                center_x = max_loc[0] + w // 2
                center_y = max_loc[1] + h // 2
                return (center_x, center_y)
                
        except Exception as e:
            print(f"Error: {e}")
            pass
        time.sleep(0.02)
    return None

# 点
def click():
    retry_loc = find()
    if retry_loc is None:
        return False
    
    pyautogui.click(retry_loc)
    time.sleep(0.01)
    pyautogui.click(retry_loc)
    return True

# ESC触发
def on_esc_pressed():
    if listening_enabled:
        click() # 点击图片的地址

# 监听
def toggle_listening():
    global listening_enabled
    listening_enabled = not listening_enabled
    
    if listening_enabled:
        print("监听已开启。")
        keyboard.add_hotkey('esc', on_esc_pressed)
    else:
        print("监听已关闭。")
        keyboard.remove_hotkey('esc')

# 主程序
if __name__ == "__main__":
    # 当 F1 键被按下时，开始监听重启挑战
    keyboard.add_hotkey('f1', toggle_listening)
    try:
        keyboard.wait()
    except KeyboardInterrupt:
        print("程序已退出。")
